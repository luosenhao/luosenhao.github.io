<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>reactTest</title>
		<link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrap.min.css"/>
		<script src="https://cdn.bootcss.com/react/15.4.2/react.min.js"></script>
		<script src="https://cdn.bootcss.com/react/15.4.2/react-dom.min.js"></script>
		<script src="https://cdn.bootcss.com/babel-standalone/6.22.1/babel.min.js"></script>
		<script src="https://cdn.bootcss.com/jquery/2.1.4/jquery.min.js"></script>
	</head>
	<style type="text/css">
		.tr_hover > td > .btn-warning{display: none;}
		.tr_hover:hover> td > .btn-warning{display: block;}
	</style>
	<body>
		<div id="example"></div>
		<div id="example1"></div>
		<div id="example2"></div>
		<div id="example3"></div>
		<div id="example4"></div>
		<div id="example5"></div>
		<div id="example6"></div>
		<div id="example7"></div>
		<div id="example8"></div>
		<div id="example9"></div>
		<div id="example10"></div>
		<div id="well"></div>
		<div class="row" id="well1" style="margin: 0px;"></div>
		<div id="well2"></div>
		<div id="table1">
			
		</div>
		<div style="height: 50px;">
			
		</div>
	</body>
	<script type="text/babel">
		var myStyle = {
			fontSize:30,
			color: 'red'
		}
		
		ReactDOM.render(
			<h1 style={myStyle}>react test</h1>,
			document.getElementById('example')
		);
		
		ReactDOM.render(
//			注释
			<div>
				<h1 style={{'fontSize':'12px'}}>{1+1}{/*注释*/}</h1>
			</div>,
			document.getElementById('example1')
		);
		
		var i=1;
		ReactDOM.render(
			<div>
				<h1>{i==1?'True!':'False'}</h1>
			</div>,
			document.getElementById('example2')
		);
		
		var HelloMessage = React.createClass({
	        render: function() {
	          return <h1>Hello World！</h1>;
	        }
	      });
	
	    ReactDOM.render(
	        <HelloMessage />,
	        document.getElementById('example3')
	    );
	    
	    var WebSite = React.createClass({
	      render: function() {
	        return (
	          <div>
	            <Name name={this.props.name} />
	            <Link site={this.props.site} target={this.props.target}/>
	          </div>
	        );
	      }
	    });
	
	    var Name = React.createClass({
	      render: function() {
	        return (
	          <h1>{this.props.name}</h1>
	        );
	      }
	    });
	
	    var Link = React.createClass({
	      render: function() {
	        return (
	          <a href={this.props.site} target={this.props.target}>
	            {this.props.site}
	          </a>
	        );
	      }
	    });
	
	    ReactDOM.render(
	      <WebSite name="菜鸟教程" site=" http://www.runoob.com" target="_blank"/>,
	      document.getElementById('example4')
	    );
	    
	    var LikeButton = React.createClass({
	    	getInitialState: function(){
	    		return {liked: false};
	    	},
	    	handleClick: function(event) {
	    		//console.log(event)
	    		this.setState({
	    			liked:!this.state.liked
	    		})
	    	},
	    	render: function(){
	    		var text = this.state.liked?'喜欢':'不喜欢';
	    		return (
	    			<div>
		    			<p onClick={this.handleClick}>
		    				我<span>{text}</span>React
		    			</p>
		    		</div>
	    		)
	    	}
	    })
	    
	    ReactDOM.render(
	    	<LikeButton />,
	    	document.getElementById('example5')
	    );
	    
	    
	    var WebSiteState = React.createClass({
	    	getInitialState: function(){
	    		return {
	    			name: "蓝鸽集团",
	    			site: "http://www.chinalancoo.com/"
	    		}
	    	},
	    	render: function(){
	    		return (
	    			<div>
	    				<NameState name={this.state.name} />
	    				<LinkState site={this.state.site} />
	    			</div>
	    		)
	    	}
	    })
	    
	    var NameState = React.createClass({
	    	render: function(){
	    		return (
	    			<h1>{this.props.name}</h1>
	    		)
	    	}
	    })
	    
	    var LinkState = React.createClass({
	    	render: function(){
	    		return (
	    			<a href={this.props.site} target="_blank">
	    				{this.props.site}
	    			</a>
	    		)
	    	}
	    })
	    
	    ReactDOM.render(
	    	<WebSiteState />,
	    	document.getElementById('example6')
	    )
	    
	    
	    var Counter = React.createClass({
	    	getInitialState: function(){
	    		return {
	    			clickCount:0,
	    			bool:true
	    		}
	    	},
	    	handleClick: function(){
	    		this.setState({bool:!this.state.bool,clickCount: this.state.clickCount +1})
	    	},
	    	render:function(){
	    		var text = this.state.bool?'redsea':'lancoo';
	    		return(
	    			<h2 onClick={this.handleClick}>{text},点击次数为:{this.state.clickCount}</h2>
	    		)
	    	}
	    })
	    
	    ReactDOM.render(
	    	<Counter />,
	    	document.getElementById('example7')
	    )
	    
	    var Button = React.createClass({
      getInitialState: function() {
        return {
          data:0
        };
      },
      setNewNumber: function() {
        this.setState({data: this.state.data + 1})
      },
      render: function () {
          return (
             <div>
                <button onClick = {this.setNewNumber}>INCREMENT</button>
                <Content myNumber = {this.state.data}></Content>
             </div>
          );
        }
    })
    var Content = React.createClass({
      componentWillMount:function() {
          //console.log('在渲染前调用,在客户端也在服务端')
      },
      componentDidMount:function() {
      		//console.log(this.getDOMNode())
           //console.log('在第一次渲染后调用，只在客户端。之后组件已经生成了对应的DOM结构，可以通过this.getDOMNode()来进行访问')
      },
      componentWillReceiveProps:function(newProps) {
      	//console.log(newProps);
            console.log('在组件接收到一个新的 prop (更新后)时被调用。这个方法在初始化render时不会被调用')
      },
      shouldComponentUpdate:function(newProps, newState) {
	  		//console.log(newProps, newState);
	  		//console.log('返回一个布尔值。在组件接收到新的props或者state时被调用。在初始化时或者使用forceUpdate时不被调用')
            return true;
      },
      componentWillUpdate:function(nextProps, nextState) {
      	//console.log(nextProps, nextState);
            //console.log('在组件接收到新的props或者state但还没有render时被调用。在初始化时不会被调用');
      },
      componentDidUpdate:function(prevProps, prevState) {
      	//console.log(prevProps, prevState);
            //console.log('在组件完成更新后立即调用。在初始化时不会被调用')
      },
      componentWillUnmount:function() {
             //console.log('在组件从 DOM 中移除的时候立刻被调用')
      },

        render: function () {
          return (
            <div>
              <h3>{this.props.myNumber}</h3>
            </div>
          );
        }
    });
      ReactDOM.render(

         <div>
            <Button />
         </div>,
        document.getElementById('example8')
      );
	    
	    
	    var UserGist = React.createClass({
        getInitialState: function() {
          return {
            username: '',
            lastGistUrl: ''
          };
        },

        componentDidMount: function() {
          this.serverRequest = $.get(this.props.source, function (result) {
            var lastGist = result[0];
            this.setState({
              username: lastGist.owner.login,
              lastGistUrl: lastGist.html_url
            });
          }.bind(this));
        },

        componentWillUnmount: function() {
          this.serverRequest.abort();
        },

        render: function() {
          return (
            <div>
              {this.state.username} 用户最新的 Gist 共享地址：
              <a href={this.state.lastGistUrl}>{this.state.lastGistUrl}</a>
            </div>
          );
        }
      });

      ReactDOM.render(
        <UserGist source="https://api.github.com/users/octocat/gists" />,
        document.getElementById('example9')
      );
      
      var Content = React.createClass({
      	render: function(){
      		//console.log(this.props)
      		return (
      			<div>
      				<input type="text" value={this.props.propsValue} onChange={this.props.propsFunction} />
      				<h4>=={this.props.propsValue}</h4>
      			</div>
      		)
      	}
      })
      
      var InputOnChange = React.createClass({
      	getInitialState: function(){
      		return {
      			inputValue: 'lancoo'
      		}
      	},
      	inputOnchange: function(event){
      		debugger
      		this.setState({inputValue:event.target.value})
      	},
      	render: function(){
      		return (
      			<div>
      				<Content propsValue={this.state.inputValue} propsFunction={this.inputOnchange} ></Content>
      			</div>
      		)
      	}
      })
      
      
      ReactDOM.render(
      	<InputOnChange />,
      	document.getElementById('example10')
      )
      
      
      var Text = React.createClass({
            getInitialState: function() {
                return {name: "react"};
            },
            keyUp: function(e){
                this.setState({name: e.target.value});
                //console.log(this.state.name);
            },
            render: function() {
                return (
                    <div className="a">
                        大家好，我是用{this.state.name}渲染出来的！
                        <input onKeyUp={this.keyUp} />
                    </div>
                );
            }
        });

        ReactDOM.render(
            <Text></Text>,
            document.getElementById('well')
        );
        
        var Child = React.createClass({
            getInitialState: function() {
                return {color: ""};
            },
            changeColor: function(e) {
            	debugger
                this.setState({color: e.target.getAttribute("data-color")});
            },
            render: function() {
                return (
                    <div style={{backgroundColor: this.state.color}} className="col-xs-5 col-xs-offset-1 child">
                        <br/>
                        <ul className="list-inline">
                            <li><a href="javascript:void(0);" data-color="#286090" className="btn btn-primary" onClick={this.props.parentChangeColor}>&nbsp;</a></li>
                            <li><a href="javascript:void(0);" data-color="#31b0d5" className="btn btn-info" onClick={this.props.parentChangeColor}>&nbsp;</a></li>
                            <li><a href="javascript:void(0);" data-color="#c9302c" className="btn btn-danger" onClick={this.props.parentChangeColor}>&nbsp;</a></li>
                            <li><a href="javascript:void(0);" data-color="#ec971f" className="btn btn-warning" onClick={this.props.parentChangeColor}>&nbsp;</a></li>
                            <li><a href="javascript:void(0);" data-color="#ffffff" className="btn btn-default" onClick={this.props.parentChangeColor}>&nbsp;</a></li>
                        </ul>
                    </div>
                );
            }
        });

        var Parent = React.createClass({
            getInitialState: function() {
                return {color: ""};
            },
            changeColor: function(e) {
            	//console.log(e.target)
                this.setState({color: e.target.getAttribute("data-color")});
            },
            child1ChangeColor: function(e) {
            	debugger
                this.refs["child1"].changeColor(e);
            },
            child2ChangeColor: function(e) {
            	debugger
                this.refs["child2"].changeColor(e);
            },
            render: function() {
                return (
                    <div style={{backgroundColor: this.state.color}} className="col-xs-10 col-xs-offset-1 parent">
                        <br/>
                        <ul className="list-inline">
                            <li>对应第一个child</li>
                            <li><a href="javascript:void(0);" data-color="#286090" className="btn btn-primary" onClick={this.child1ChangeColor}>&nbsp;</a></li>
                            <li><a href="javascript:void(0);" data-color="#31b0d5" className="btn btn-info" onClick={this.child1ChangeColor}>&nbsp;</a></li>
                            <li><a href="javascript:void(0);" data-color="#c9302c" className="btn btn-danger" onClick={this.child1ChangeColor}>&nbsp;</a></li>
                            <li><a href="javascript:void(0);" data-color="#ec971f" className="btn btn-warning" onClick={this.child1ChangeColor}>&nbsp;</a></li>
                            <li><a href="javascript:void(0);" data-color="#ffffff" className="btn btn-default" onClick={this.child1ChangeColor}>&nbsp;</a></li>
                        </ul>
                        <ul className="list-inline">
                            <li>对应第二个child</li>
                            <li><a href="javascript:void(0);" data-color="#286090" className="btn btn-primary" onClick={this.child2ChangeColor}>&nbsp;</a></li>
                            <li><a href="javascript:void(0);" data-color="#31b0d5" className="btn btn-info" onClick={this.child2ChangeColor}>&nbsp;</a></li>
                            <li><a href="javascript:void(0);" data-color="#c9302c" className="btn btn-danger" onClick={this.child2ChangeColor}>&nbsp;</a></li>
                            <li><a href="javascript:void(0);" data-color="#ec971f" className="btn btn-warning" onClick={this.child2ChangeColor}>&nbsp;</a></li>
                            <li><a href="javascript:void(0);" data-color="#ffffff" className="btn btn-default" onClick={this.child2ChangeColor}>&nbsp;</a></li>
                        </ul>
                        <hr/>

                        <Child ref="child1" parentChangeColor={this.changeColor} />
                        <Child ref="child2" parentChangeColor={this.changeColor} />
                    </div>
                );
            }
        });


        ReactDOM.render(
            <Parent/>,
            document.getElementById('well1')
        );
        
        var Text = React.createClass({
            getInitialState: function() {
                return {cur_time: 0};
            },
            request: function() {
                $.ajax({
                    type: "GET",
                    url: "",
                    success: function(data){
                        this.setState({cur_time: data.timestamp});
                    }.bind(this),
                    complete: function(){//只要请求结束，无论失败与否
                        this.setState({cur_time: Date.parse(new Date()) / 1000});
                    }.bind(this),
                    error: function(){
                    	
                    }.bind(this)
                });
            },
            componentDidMount: function(){
                setInterval(this.request, 1000);
            },
            render: function() {
                return (
                    <div className="col-xs-12">
                        当前时间{this.state.cur_time}
                        <div className={ this.state.cur_time % 2 == 0?"hidden": "col-xs-6 alert alert-success"}>
                            <span>最后一位奇数</span>
                        </div>
                        <div className={ this.state.cur_time % 2 != 0?"hidden": "col-xs-6 alert alert-danger"}>
                            <span>最后一位偶数</span>
                        </div>
                    </div>
                );
            }
        });

        ReactDOM.render(
            <Text></Text>,
            document.getElementById('well2')
        );
        
        var Table = React.createClass({
        	getDefaultProps: function(){
        		return{
        			test:true
        		}
        	},
        	getInitialState: function(){
        		return {
        			data:[1]
        		}
        	},
        	updateParentData: function(){
        		var arr = this.state.data;
        		var arrLength = arr.length;
        		var num = arrLength+1;
        		arr.push(num);
        		this.setState({data:arr})
        	},
        	componentDidMount: function(){
	        	setInterval(this.updateParentData, 5000)
        	},
//      	shouldComponentUpdate:function(newProps, newState){
//      		console.log(this.state.data)
//      		console.log(newState.data)
//      		var isTrue = (this.state.data !== newState.data) ? true : false;
//      		return isTrue;
//      	},
        	render: function(){
        		var that = this;
        		return(
        			<table className="table table-condensed table-hover">
        				<thead>
        					<tr>
        						<th>序号</th>
        						<th>内容</th>
        						<th>操作</th>
        					</tr>
        				</thead>
        				<tbody>
        				{
							this.state.data.map(function(o, i) {
						   		return <TableTr dataValue={o} index={i} updateParentData={that.updateParentData}/>
						   	})
						}
        				</tbody>
        			</table>
        		)
        	}
        })
        
        var TableTr = React.createClass({
//      	componentDidMount: function(){
//	        	setInterval(this.props.updateParentData, 5000)
//      	},
        	render: function(){
        		return (
        			<tr className="tr_hover" style={{height:"34px"}}>
        				<td>{this.props.index}</td>
        				<td>{this.props.dataValue}</td>
        				<td>
        					<button type="button" className="btn btn-xs btn-warning"><span className="glyphicon glyphicon-heart"></span></button>
        				</td>
        			</tr>
        		)
        	}
        })
        
//      TableTr.propTypes = {
//			index: React.PropTypes.bool
//		};

        ReactDOM.render(
        	<Table />,
        	document.getElementById('table1')
        )
	</script>
	
</html>
